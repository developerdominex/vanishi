<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Register — Hybrid Chat</title>
<link rel="icon" type="image/png" href="hybrid.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root {
  --accent:#6366f1;
  --accent-hover:#4f46e5;
  --bg:#f9fafb;
  --card:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --shadow:rgba(0,0,0,0.08);
}
*{box-sizing:border-box;margin:0;padding:0;font-family:Inter,sans-serif;}
body{
  height:100vh;background:var(--bg);
  display:flex;align-items:center;justify-content:center;
  overflow:hidden;
}
.reg-card{
  background:var(--card);
  padding:40px 32px;
  border-radius:20px;
  width:100%;
  max-width:400px;
  box-shadow:0 8px 24px var(--shadow);
  text-align:center;
  position:relative;
}
h2{font-size:24px;font-weight:700;margin-bottom:20px;color:var(--text);}
p{color:var(--muted);margin-bottom:24px;font-size:15px;}
button.google-btn{
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding:12px 16px;
  font-size:15px;
  font-weight:500;
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  width:100%;
  cursor:pointer;
  transition:all 0.2s ease;
}
button.google-btn:hover{background:#f3f4f6;}
.google-btn img{width:22px;height:22px;}
footer{margin-top:24px;font-size:12px;color:var(--muted);}

/* Profile display */
.profile{
  display:none;
  flex-direction:column;
  align-items:center;
  animation:fadeIn 0.6s ease forwards;
}
.profile img{
  width:90px;height:90px;border-radius:50%;
  margin-bottom:12px;
  box-shadow:0 4px 10px var(--shadow);
}
.profile h3{font-size:20px;font-weight:600;margin-bottom:4px;}
.profile span{font-size:14px;color:var(--muted);}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}

/* Loading animation */
.loading-overlay{
  position:fixed;top:0;left:0;right:0;bottom:0;
  display:none;flex-direction:column;align-items:center;justify-content:center;
  background:rgba(255,255,255,0.95);z-index:999;
}
.loading-animation{
  display:flex;align-items:center;gap:20px;
  animation: float 2s ease-in-out infinite;
}
@keyframes float{
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-8px);}
}
.loading-animation i{font-size:48px;color:var(--accent);}
.loading-dots{display:flex;gap:6px;margin-top:12px;}
.loading-dots span{
  width:8px;height:8px;background:var(--accent);
  border-radius:50%;
  animation:dots 1.4s infinite ease-in-out;
}
.loading-dots span:nth-child(2){animation-delay:0.2s;}
.loading-dots span:nth-child(3){animation-delay:0.4s;}
@keyframes dots{0%,80%,100%{transform:scale(0);}40%{transform:scale(1);}}
</style>
</head>
<body>

<div class="reg-card">
  <h2>Welcome to Hybrid Chat</h2>
  <p>Sign in securely with Google to continue.</p>

  <button class="google-btn" id="googleSignIn">
    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
    Sign in with Google
  </button>

  <div class="profile" id="profile">
    <img id="profilePic" alt="Profile Picture">
    <h3 id="profileName"></h3>
    <span id="profileEmail"></span>
  </div>

  <footer>Hybrid Chat © 2025 Dominex Macedon</footer>
</div>

<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-animation">
    <i class="fab fa-google"></i>
    <i class="fas fa-arrow-right" style="font-size:28px;color:#6b7280;"></i>
    <i class="fab fa-google-drive"></i>
  </div>
  <div class="loading-dots"><span></span><span></span><span></span></div>
</div>

<!-- Google APIs -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js"></script>

<script>
const CLIENT_ID='549003131640-o9umsg7tu0uisopde76mlf3lg5krt5g7.apps.googleusercontent.com';
const SCOPES='https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email';
let tokenClient;

const loadingOverlay=document.getElementById('loadingOverlay');
const googleBtn=document.getElementById('googleSignIn');
const profileCard=document.getElementById('profile');
const profilePic=document.getElementById('profilePic');
const profileName=document.getElementById('profileName');
const profileEmail=document.getElementById('profileEmail');

googleBtn.addEventListener('click',async()=>{
  loadingOverlay.style.display='flex';
  await gapi.load('client',initGapi);
});

async function initGapi(){
  await gapi.client.init({
    discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]
  });
  tokenClient=google.accounts.oauth2.initTokenClient({
    client_id:CLIENT_ID,
    scope:SCOPES,
    callback:handleToken
  });
  tokenClient.requestAccessToken({prompt:'consent'});
}

async function handleToken(tokenResponse){
  if(tokenResponse.error){console.error(tokenResponse);return;}
  const accessToken=gapi.client.getToken().access_token;
  const userInfo=await fetch('https://www.googleapis.com/oauth2/v2/userinfo',{
    headers:{'Authorization':'Bearer '+accessToken}
  }).then(r=>r.json());
  displayUser(userInfo);
}

function displayUser(user){
  loadingOverlay.style.display='none';
  googleBtn.style.display='none';
  profileCard.style.display='flex';
  profilePic.src=user.picture;
  profileName.textContent=user.name;
  profileEmail.textContent=user.email;
  const profileData={
    uuid:crypto.randomUUID(),
    name:user.name,
    email:user.email,
    avatar:user.picture,
    createdAt:new Date().toISOString()
  };
  localStorage.setItem('rc_profile_v2',JSON.stringify(profileData));
  setTimeout(()=>{window.location.href='index.html'},1500);
}

// Disable right-click/devtools
document.addEventListener('contextmenu', e=>e.preventDefault());
document.addEventListener('keydown', e=>{
  if(e.key==='F12'||(e.ctrlKey&&e.shiftKey&&['I','J','C'].includes(e.key.toUpperCase()))||(e.ctrlKey&&['U','S','P'].includes(e.key.toUpperCase()))){
    e.preventDefault(); e.stopPropagation();
  }
});
</script>
</body>
</html>
